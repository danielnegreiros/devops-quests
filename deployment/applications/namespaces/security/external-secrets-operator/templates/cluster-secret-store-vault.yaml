apiVersion: external-secrets.io/v1
kind: ClusterSecretStore
metadata:
  name: cluster-secret-store-vault-cluster
  annotations:
    "helm.sh/hook": post-install,post-upgrade
spec:
  provider:
    vault:
      server: "http://vault.security.svc.cluster.local:8200"
      path: cluster
      namespace: security
      version: "v2"
      auth:
        # VaultAppRole authenticates with Vault using the
        # App Role auth mechanism
        # https://www.vaultproject.io/docs/auth/approle
        appRole:
          # Path where the App Role authentication backend is mounted
          path: "approle"
          # RoleID configured in the App Role authentication backend
          roleRef:
            name: "approle-external-secret-operator-secret"
            key: "role_id"
            namespace: "security"          # Reference to a key in a K8 Secret that contains the App Role SecretId
          secretRef:
            name: "approle-external-secret-operator-secret"
            key: "secret_id"
            namespace: "security"
